import { ethers, viem } from 'hardhat'

import { decodeEventLog, parseEther, zeroAddress } from 'viem'

import { deployPxls } from './MagicPixels'
import { deployPlts } from './MagicPlates'
import { openTrade } from './trade'
import { colors } from './colors'
import { FacetCutAction, getSelectors } from './libraries/diamond'


export async function updatePxls() {
	const [acc1, acc2, p] = await viem.getWalletClients()
	const publicClient = await viem.getPublicClient()

	const diamondAddr = "0xD21aC4aDDE5d4D7a2A351a97B39B8096F9cE9d35"; // await deployPxls();

	// await (await viem.getContractAt("MagicPlates", "0xc7b67C4C821981d811E3BFD473A67AE87749Df42")).write.setColors([colors])

	// const pxlsAdmin = await viem.getContractAt("PxlsSetters", diamondAddr)
	// pxlsAdmin.write.setMagicPlates(["0xc7b67C4C821981d811E3BFD473A67AE87749Df42"])

	const pxlsAdmin = await viem.getContractAt("PxlsSetters", diamondAddr)
	await pxlsAdmin.write.setPrice([parseEther("0.01")]) // 0.02

	// const pxlsAdmin = await viem.getContractAt("PxlsAdmin", diamondAddr)
	// await pxlsAdmin.write.adminMint([
	// 	"0x536c6565706f20506565706f00000000",
	// 	"0xbe00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be0019bfbe00be00be00be00be00be0003008b00888a030004000300be00be00be001989be00be00be00be00be00be00be00be00be00be00be00be0002008a008a0003001e0003000c001e0004001400be00be00be00be00be00be00be00be00be00be00be00be00be00030004008a001e0003001e0003008a0089008a008b000300be00be00be00be001941be00be00be00be00be00be0038bf04008a00888a03008a008a001e009193030038bf0300888a04000300be00be00be00be00be00be00be00be00404238bf1e008a008a000c0015008a008a008a00030040001e008a001e0003008900be00be00be00be00be00be00be00404138bfbe0089009300370037000300030089008900890089008900150004000500be00be00be00be00be00be00be00be00be00be008a008a008900919389000c008a008a00040004000500050021002400be00be00be00be00be00be00be00be00be00be000f000e00050005000e00050006001a0019004f002400230017001f001b00be00be00be00be00be00be001941be00be0051004f004f004f005100be0021001f00220040bf1800be00110019002200be00be00be00be00be00be00be00be0051004e004f005100170040bfbe00be001a001a001f00200023005a002400be00be00be00be00be00be00be00be00190051004f004f004800480020002200230023004f004f004f00210020003600be001989be00be00be00be00be00be000500040020005000480036003f003e004600460047003e003500350036002400be00be00be00be00be001989be00be00050005008a008a0005001800210022004800480048004800230022000e0005001700be0019bfbe00be00be00be0018000500888a05008900890089008a000400040004000400040004008a007f0088000800be00be00be00be00be00be00190004007f000500040091938a000c001d008900890089008900920089008a0089000600be00be00be00be00be00be0018008a000400050014001e00888a930003008a00030038bf93008a008a000300920005001700be00be00be00be00be0019008a000400050002001e0091938a008a008a009300030091938a00888a0300890004001800be00be00be00be00be00be0019002200050089008a0093008a00930003008a008a008a00030015008a00890005002200be00be00be00be00be00be00060017000d008900030003008a0003001e008a00888a8a000c001e008a0089000500be00be00be00be00be00be00be00050089001c0003008a0091930300888a8a00888a8a0093008a008a00890004001700be00be00be00be001941be00be00be00050004008900890089001e0093008a00919303008900890092008a000f00be00be00be00be00be00be00be00be00be00be0017000f000400040093002200be0022000300040004000e002200be00be00be0019bfbe00be00be00be00be00be00be00be00be00500050001900be00be00be001900500050002400be00be00be00be00be00be00",
	// 	"0x001900320029006e0064000100670050007b0028007c005e0093006e0094003c00b1003c00db005000e7002b011d0046013900640189004601a7005a01a9006401d6001401e9005001ed003201f900590205003c02260074023f0046"
	// ])

	// await pxlsAdmin.write.adminMint([
	// 	"0x4e657468657200000000000000000000",
	// 	"0xbe00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be0094979394be00be00be00be001abebe00be00be00be00be00be00be00be00be00be00be00be00be001abebe00be00be0093949497be00be00be00be00be00be00be00be00be00be00be00be00be001abebe00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be0054565759be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be0057595456be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00b8bab8bab8babe00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00b8bab8bab8babe00be00be00be00be00be00be00be00be00be00be00be001abebe00be00be00be00be00be00be00be00b8bab8bab8babe00be00be00be00be001abebe00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00777977797779be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be0077796e6f7779be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00777977797779be00be00be00be00be00be00be00be00be00be00be00be001c1e1c1e1c1ebe00be00be00be00be00be00be00be00be00be00be00be00be00be00be001abebe00be00be00be00be001c1e1c1e1c1ebe00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be001c1e1c1e1c1ebe00be00be00be001abebe00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00393b4446be00be00be00be00be00be00be00be00be00be00adb7adb7adb7be00be00be00be00be00be00be00be00be004446393bbe00be00be00be00be001abebe00be00be00be00adb7a3a4adb7be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00adb7adb7adb7be00be00be001abebe00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be001abebe00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00be00",
	// 	"0x001e001e001f003200240028003200280036005a0037005000450075006f00380070004600930061009400140095006e00ab002300ac000100ad000c00ba000000c3004100c4003c00c5004600cb002e00ea003200eb001400ec00360102006b01040056011a0014011b005a011c003201290043012a0059012b000f013b003f01410027014200000143004b01590056015a0023015b00650160003c01b3005a01b4003201bf006401c0004601c1000a01cc002801d2000a01d7001e01d8000101d9005a01ef005001f0004601f1001401f5005002120025"
	// ])


	// const cutFacet = await viem.getContractAt("DiamondCutFacet", diamondAddr)
	// const loupeFacet = await viem.getContractAt("DiamondLoupeFacet", diamondAddr)

	// const oldCoreAddr = "0x1b91CC867D13dC45cb15329345D1aBE2Eab8F4D9"
	// const oldCoreSelectors = await loupeFacet.read.facetFunctionSelectors([oldCoreAddr])

	// await cutFacet.write.diamondCut([
	// 	[
	// 		{ 
	// 			facetAddress: zeroAddress,
	// 			action: FacetCutAction.Remove,
	// 			functionSelectors: oldCoreSelectors
	// 		}
	// 	],
	// 	zeroAddress,
	// 	"0x"
	// ])

	// console.log(await loupeFacet.read.facetFunctionSelectors([oldCoreAddr]))

	// const pxlsCoreNew = await viem.getContractAt("PxlsMain", "0x20C04856c00Ae7d012c55f988Ef6532D8b39739C")

	// await cutFacet.write.diamondCut([
	// 	[
	// 		{
	// 			facetAddress: pxlsCoreNew.address,
	// 			action: FacetCutAction.Add,
	// 			functionSelectors: getSelectors(pxlsCoreNew.abi)
	// 		}
	// 	],
	// 	zeroAddress,
	// 	"0x"
	// ])

	// console.log(await loupeFacet.read.facetFunctionSelectors([pxlsCoreNew.address]))

	// console.log(pxlsCoreNew.address)
}

updatePxls().catch((error) => {
  console.error(error)
  process.exitCode = 1
})
